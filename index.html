<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä»»å‹™å—ç†æ¡Œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
    
    /* LINE é¢¨æ ¼é…è‰² */
    :root {
      --line-green: #06C755;
      --line-bg: #F5F6F8;
    }
    
    body { 
      font-family: 'Noto Sans TC', sans-serif; 
      background-color: var(--line-bg); 
    }
    
    /* è‡ªè¨‚ LINE ç¶ è‰²æŒ‰éˆ• */
    .btn-line {
      background-color: var(--line-green);
      color: white;
      transition: all 0.2s;
    }
    .btn-line:active {
      background-color: #05b34c;
      transform: scale(0.98);
    }
    
    /* è¼¸å…¥æ¡†èšç„¦æ™‚çš„ç¶ è‰²å¤–æ¡† */
    .input-line:focus {
      border-color: var(--line-green);
      ring-color: var(--line-green);
      outline: none;
      box-shadow: 0 0 0 3px rgba(6, 199, 85, 0.2);
    }
  </style>
</head>
<body class="flex justify-center items-start min-h-screen">

  <div class="w-full max-w-md bg-white min-h-screen shadow-sm flex flex-col">
    
    <div class="bg-[#06C755] p-4 text-center sticky top-0 z-10 shadow-sm">
      <h1 class="text-lg font-bold text-white tracking-wide">
        ç‰¹åŠ©ç‹—è¨­è¨ˆä»»å‹™å–®
      </h1>
    </div>

    <form id="taskForm" class="p-5 space-y-5 flex-grow">
      
      <div class="bg-green-50 text-green-800 text-xs p-3 rounded-lg border border-green-100">
        ğŸ’¡ ç”±ç‰¹åŠ©ç‹—æ§ç®¡çš„è¨­è¨ˆä»»å‹™æ›´ä¸æœƒå¤±æ§ï¼
      </div>

      <div>
        <label class="block text-gray-800 text-sm font-bold mb-1.5">ğŸ‘¤ æ‚¨çš„ç¨±å‘¼</label>
        <input type="text" id="userName" class="input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
          placeholder="ä¾‹å¦‚ï¼šKaren / éŠæˆ²éƒ¨é–€" required>
      </div>

      <div>
        <label class="block text-gray-800 text-sm font-bold mb-1.5">ğŸ“Œ é …ç›®å…§å®¹</label>
        <input type="text" id="project" class="input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
          placeholder="ä¾‹å¦‚ï¼šè”šè—æª”æ¡ˆ / ç·šä¸Š / Banner" required>
      </div>

      <div>
        <label class="block text-gray-800 text-sm font-bold mb-1.5">ğŸ“ è¦æ ¼å‚™è¨»</label>
        <textarea id="spec" rows="3" class="input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
          placeholder="å°ºå¯¸ã€æè³ªã€ç‰¹æ®Šè¦æ±‚..."></textarea>
      </div>

      <div>
        <label class="block text-gray-800 text-sm font-bold mb-1.5">ğŸ“… å¸Œæœ›æˆªç¨¿æ—¥</label>
        <input type="date" id="deadline" class="input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" required>
      </div>

      <div>
        <label class="block text-gray-800 text-sm font-bold mb-1.5">ğŸ”— ç´ æé€£çµ</label>
        <div id="links-container" class="space-y-2">
          <input type="text" class="link-item input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
            placeholder="ä¾‹å¦‚ï¼šå…¬æª”é€£çµ æˆ–æ˜¯ http://">
        </div>
        <button type="button" onclick="addLinkField()" class="mt-3 text-sm text-[#06C755] font-bold hover:text-green-700 flex items-center gap-1 px-1 py-1 rounded transition">
          <span class="text-lg">ï¼‹</span> å¢åŠ ä¸€çµ„é€£çµ
        </button>
      </div>

      <div class="pt-4 pb-4">
        <button type="button" onclick="submitData()" id="submitBtn" class="w-full btn-line font-bold py-3.5 px-4 rounded-lg shadow-sm text-base flex justify-center items-center gap-2">
          <span>ğŸš€ é€å‡ºä»»å‹™</span>
        </button>
      </div>
    </form>
    
    <div class="text-center text-xs text-gray-400 pb-8 pt-2">
      Design by karen
    </div>
  </div>

  <script>
    // ğŸ”´ğŸ”´ğŸ”´ è«‹å‹™å¿…è¨˜å¾—æŠŠé€™è£¡æ›æˆæ‚¨çš„ Google Script ç¶²å€ï¼ ğŸ”´ğŸ”´ğŸ”´
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxKOQca5G4SzrnIqMSNeY5V_ffJoXr4cCi5yFkDdX2hFQ6-HxRbINY2Exy0ys3rPVQ/exec";

    // å‹•æ…‹æ–°å¢é€£çµæ¬„ä½çš„åŠŸèƒ½
    function addLinkField() {
      const container = document.getElementById('links-container');
      const div = document.createElement('div');
      div.className = "flex gap-2 items-center animate-fade-in"; // åŠ å…¥ flex æ’ç‰ˆ
      
      // æ–°çš„è¼¸å…¥æ¡† HTML
      div.innerHTML = `
        <input type="text" class="link-item input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
          placeholder="é‚„æœ‰å…¶ä»–é€£çµå—ï¼Ÿ">
        <button type="button" onclick="this.parentElement.remove()" class="text-gray-400 hover:text-red-500 p-2 text-xl font-bold" title="åˆªé™¤æ­¤é€£çµ">
          âœ•
        </button>
      `;
      container.appendChild(div);
    }

    function submitData() {
      const btn = document.getElementById('submitBtn');
      
      // 1. æ”¶é›†æ‰€æœ‰é€£çµæ¬„ä½çš„å€¼
      const linkInputs = document.querySelectorAll('.link-item');
      let allLinks = [];
      linkInputs.forEach(input => {
        if(input.value.trim() !== "") {
          allLinks.push(input.value.trim());
        }
      });
      // æŠŠé€£çµä¸²èµ·ä¾†ï¼Œç”¨æ›è¡Œç¬¦è™Ÿéš”é–‹
      const finalLinkString = allLinks.join('\n');

      // 2. æº–å‚™è¦å‚³é€çš„è³‡æ–™
      const data = {
        userName: document.getElementById('userName').value,
        project: document.getElementById('project').value,
        spec: document.getElementById('spec').value,
        deadline: document.getElementById('deadline').value,
        link: finalLinkString // å‚³é€ä¸²æ¥å¥½çš„é€£çµ
      };

      // æª¢æŸ¥å¿…å¡«
      if(!data.userName || !data.project) {
        Swal.fire({ 
          icon: 'warning', 
          title: 'è³‡æ–™æœªå¡«å®Œ', 
          text: 'ã€Œç¨±å‘¼ã€å’Œã€Œé …ç›®åç¨±ã€æ˜¯å¿…å¡«çš„å–”ï¼', 
          confirmButtonColor: '#06C755' 
        });
        return;
      }

      // é–å®šæŒ‰éˆ•
      btn.disabled = true; 
      btn.innerHTML = 'ğŸ”„ å‚³é€ä¸­...';
      btn.classList.add('opacity-70');

      // ç™¼é€è³‡æ–™
      fetch(GOOGLE_SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(data),
        mode: "no-cors" 
      }).then(() => {
        // æˆåŠŸ
        Swal.fire({ 
          icon: 'success', 
          title: 'ç™¼é€æˆåŠŸï¼', 
          text: 'ç‹—ç‹—å·²ç¶“æ”¶åˆ°æ‚¨çš„ä»»å‹™äº†ï¼', 
          confirmButtonColor: '#06C755' 
        });
        document.getElementById('taskForm').reset();
        
        // é‡ç½®é€£çµæ¬„ä½ (åªä¿ç•™ç¬¬ä¸€å€‹)
        document.getElementById('links-container').innerHTML = `
          <input type="text" class="link-item input-line w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700" 
            placeholder="ä¾‹å¦‚ï¼šå…¬æª”é€£çµ æˆ–æ˜¯ http://">
        `;

        btn.disabled = false; 
        btn.innerHTML = '<span>ğŸš€ é€å‡ºä»»å‹™</span>';
        btn.classList.remove('opacity-70');
      }).catch(err => {
        // å¤±æ•—
        console.error(err);
        Swal.fire({ icon: 'error', title: 'å¤±æ•—', text: 'ç¶²è·¯æ€ªæ€ªçš„ï¼Œè«‹å†è©¦ä¸€æ¬¡' });
        btn.disabled = false; 
        btn.innerHTML = '<span>ğŸš€ é€å‡ºä»»å‹™</span>';
      });
    }
  </script>
</body>
</html>
